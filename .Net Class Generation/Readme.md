# How to generate classes for the AnIML Core and Technique Xml Schema Definition files using xsd.exe

1. Download the AnIML schema(s) from https://github.com/AnIML/schemas to a local folder.
2. Download the XML DSig schema from https://www.w3.org/TR/xmldsig-core/xmldsig-core-schema.xsd as it is referenced in the AnIML core schema.
3. Use xsd.exe to generate classes from the AnIML schemas (`<schemadir>` is the directory where the XML schemas are located):
	- `xsd.exe <schemadir>\xmldsig-core-schema.xsd <schemadir>\animl-core.xsd /c /o:<schemadir>`
	- `xsd.exe <schemadir>\animl-technique.xsd /c /o:<schemadir>`

Notes:
* The xsd.exe is shipped with Visual Studio and is directly accessible when opening a Visual Studio Developer Command Prompt.
* For generating classes for the core schema you have to specify both the XML DSig schema and the AnIML core schema files as parameter for the xsd.exe.
* The output file generated by xsd.exe will be named `<schema_1>_<schema_2>_...<schema_n>.xsd`
* The default output of xsd.exe is C# code. To generate classes for a different language use the `/l:` parameter. See `xsd.exe /?` for possible parameter values.
* The parameter `/n:` can be used to generate classes in a specific namespace.

# Using the generated classes to read AnIML files

Reading AnIML files in C# is pretty simple when you have generated classes from your xsd files. Simply use the XmlSerializer in combination with a StreamReader and you are able to access all elements in your file.

```csharp
namespace AnimlTest
{
    using System;
    using System.IO;
    using System.Text;
    using System.Xml.Serialization;

    public class Program
    {
        public static void Main(string[] args)
        {
            XmlSerializer serializer = new XmlSerializer(typeof(AnIMLType));
            AnIMLType animlFile;

            using (StreamReader reader = new StreamReader(@"C:\temp\myfile.animl", Encoding.UTF8))
            {
                animlFile = (AnIMLType)serializer.Deserialize(reader);
            }

            Console.WriteLine(
                $"AnIML file contains {animlFile.SampleSet.Sample.Length} samples " +
                $"and {animlFile.ExperimentStepSet.ExperimentStep.Length} experiment steps.");

            Console.ReadKey();
        }
    }
}
```

So it's pretty simple to read the document but working with the contents requires special attention as the generated classes do not respect the constraints defined in the XSD. So it's the task of the developer to ensure that the generated AnIML file is compliant to the schema.